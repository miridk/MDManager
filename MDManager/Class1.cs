using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace MDManager
{
    class Class1
    {

        //InitialSessionState iss = InitialSessionState.CreateDefault();
        //Runspace rs = RunspaceFactory.CreateRunspace(iss);
        //rs.Open();
        ////File.Copy("..\\..\\Scripts\\angular.ps1", SolutionInstallPath + "\\angular.ps1");
        //PowerShell ps = PowerShell.Create();
        //ps.Runspace = rs;
        //ps.AddScript(File.ReadAllText(@"..\..\Scripts\angular.ps1"))
        ////ps.AddScript(File.ReadAllText(@"" + SolutionInstallPath + "\\angular.ps1"))
        //        .AddParameter(null, FrontendName)
        //        .AddParameter(null, SolutionFolder)
        //        .AddParameter(null, runFrontendWhenFinished)
        //        .AddParameter(null, SolutionInstallPath);
        //        ps.Invoke();


        //RunspaceConfiguration runspaceConfiguration = RunspaceConfiguration.Create();
        //Runspace runspace = RunspaceFactory.CreateRunspace(runspaceConfiguration);
        //runspace.Open();
        //Pipeline pipeline = runspace.CreatePipeline();

        //Here's how you add a new script with arguments
        //Command myCommand = new Command(@"..\..\Scripts\angular.ps1");
        //CommandParameter testParam = new CommandParameter("key", "value");
        //myCommand.Parameters.Add(FrontendName);
        //myCommand.Parameters.Add(SolutionFolder);
        //myCommand.Parameters.Add(runFrontendWhenFinished);
        //myCommand.Parameters.Add(SolutionInstallPath);
        //pipeline.Commands.Add(ps);

        //// Execute PowerShell script
        //pipeline.Invoke();




        // TODO

        //File.Copy(SolutionInstallPath, SolutionInstallPath);

        //PowerShell ps = PowerShell.Create();
        //ps.AddScript(File.ReadAllText(@"..\..\Scripts\manager.ps1"))
        //        .AddParameter(null, SolutionInstallPath)
        //        .AddParameter(null, ApiPortNo)
        //        .Invoke();
    }
}
